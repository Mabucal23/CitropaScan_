# This file defines your infrastructure on Render
services:
  # 1. Web Service Definition (Your Flask App)
  - type: web
    name: citropascan-flask  # Customize this name
    env: python
    region: frankfurt # Use a region close to your users (e.g., oregon or frankfurt)
    plan: free # Use 'standard' for a paid, faster service
    buildCommand: "pip install -r requirements.txt"
    startCommand: "gunicorn app:app" # Must match your Procfile start command
    healthCheckPath: /
    autoDeploy: true # Automatically redeploy when you push to GitHub
    envVars:
      # CRITICAL: Fixes Python 3.13 compatibility issue
      - key: RENDER_PYTHON_VERSION
        value: 3.11.8 # Recommended: Use 3.11.8 or 3.12.2 for stability
      # CRITICAL: This is where you securely store your serviceAccountKey.json content.
      # Render will automatically parse the JSON string when deploying.
      - key: GOOGLE_CREDENTIALS_JSON
        # NOTE: You must set the ACTUAL JSON value in the Render UI for security.
        # We set sync: false to prevent the secret from being stored in this file.
        sync: false 
      # Set your Flask App's secret key (generate a long random string)
      - key: SECRET_KEY 
        value: "generate_a_long_random_key_here"